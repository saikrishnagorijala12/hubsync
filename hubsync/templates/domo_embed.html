<!doctype html>
<html>

<head>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/domo_embed.css') }}">
</head>

<body>

    <div class="tabs">
        {% for item in embeds %}
        <div class="tab {% if loop.first %}active{% endif %}" data-target="frame{{ loop.index }}">
            Dashboard {{ loop.index }}
        </div>
        {% endfor %}
    </div>

    {% for item in embeds %}
    <form id="form{{ loop.index }}" action="{{ host }}/embed/pages/{{ item.id }}" method="post"
        target="frame{{ loop.index }}">
        <input type="hidden" name="embedToken" value="{{ item.token }}">
    </form>

    <iframe name="frame{{ loop.index }}" id="frame{{ loop.index }}" class="{% if loop.first %}active{% endif %}">
    </iframe>
    {% endfor %}

<script>
document.querySelectorAll("form").forEach(form => form.submit());
document.querySelectorAll(".tab").forEach(tab => {
    tab.addEventListener("click", () => {
        document.querySelectorAll(".tab").forEach(t => t.classList.remove("active"));
        document.querySelectorAll("iframe").forEach(f => f.classList.remove("active"));

        tab.classList.add("active");
        document.getElementById(tab.dataset.target).classList.add("active");
    });
});
</script>

</body>
</html>
